<Page x:Class="WindowsDebloater.Pages.BackgroundAppsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.modernwpf.com/2019"
      Title="BackgroundApps">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="40,30,40,30">
            <!-- Header -->
            <TextBlock Text="Background Apps Manager" 
                      FontSize="28" 
                      FontWeight="SemiBold"
                      Margin="0,0,0,10"/>
            <TextBlock Text="Manage and kill resource-heavy background applications" 
                      FontSize="14" 
                      Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                      Margin="0,0,0,30"/>

            <!-- Controls -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                <Button Content="Refresh List" 
                       Click="RefreshButton_Click"
                       Margin="0,0,10,0"
                       Padding="15,8"/>
                <Button Content="Kill Selected" 
                       Click="KillSelectedButton_Click"
                       Margin="0,0,10,0"
                       Padding="15,8"
                       Style="{StaticResource AccentButtonStyle}"/>
                <CheckBox x:Name="AutoKillCheckBox"
                         Content="Auto-kill high memory apps (>500MB)"
                         VerticalAlignment="Center"
                         Margin="20,0,0,0"
                         Checked="AutoKillCheckBox_Changed"
                         Unchecked="AutoKillCheckBox_Changed"/>
            </StackPanel>

            <!-- Process List -->
            <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                   BorderThickness="1"
                   CornerRadius="4"
                   Padding="0">
                <Grid>
                    <ListView x:Name="ProcessListView"
                             Height="400"
                             SelectionMode="Extended"
                             BorderThickness="0">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Process Name" Width="250">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding ProcessName}" FontWeight="SemiBold"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="Memory (MB)" Width="120">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding MemoryMB}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="CPU %" Width="100">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding CpuPercent}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="PID" Width="100">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding ProcessId}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="Status" Width="150">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Status}" 
                                                      Foreground="{Binding StatusColor}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>
                </Grid>
            </Border>

            <!-- Status -->
            <TextBlock x:Name="StatusTextBlock" 
                      Margin="0,15,0,0"
                      FontSize="13"
                      Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
        </StackPanel>
    </ScrollViewer>
</Page>
