<Page x:Class="WindowsDebloater.Pages.RegistryCleanerPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.modernwpf.com/2019"
      Title="RegistryCleaner">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="40,30,40,30">
            <!-- Header -->
            <TextBlock Text="🧹 Registry Turbo Cleaner" 
                      FontSize="28" 
                      FontWeight="SemiBold"
                      Margin="0,0,0,10"/>
            <TextBlock Text="Deep scan and clean invalid registry entries" 
                      FontSize="14" 
                      Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                      Margin="0,0,0,30"/>

            <!-- Warning -->
            <Border Background="#FFF3CD" BorderBrush="#FFC107" BorderThickness="1" 
                   CornerRadius="4" Padding="15" Margin="0,0,0,20">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="⚠️" FontSize="20" Margin="0,0,10,0"/>
                    <TextBlock Text="Always create a system restore point before cleaning the registry!" 
                              TextWrapping="Wrap" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Controls -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                <Button Content="🔍 Scan Registry" 
                       Click="ScanRegistry_Click"
                       Margin="0,0,10,0"
                       Padding="20,10"
                       FontWeight="SemiBold"
                       Style="{StaticResource AccentButtonStyle}"/>
                <Button Content="🧹 Clean Selected" 
                       Click="CleanSelected_Click"
                       Margin="0,0,10,0"
                       Padding="20,10"
                       IsEnabled="False"
                       x:Name="CleanButton"/>
                <Button Content="🗑️ Clean All" 
                       Click="CleanAll_Click"
                       Margin="0,0,10,0"
                       Padding="20,10"
                       IsEnabled="False"
                       x:Name="CleanAllButton"/>
                <Button Content="💾 Create Backup" 
                       Click="CreateBackup_Click"
                       Padding="20,10"/>
            </StackPanel>

            <!-- Scan Progress -->
            <Border x:Name="ScanProgressBorder" 
                   Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                   BorderThickness="1" CornerRadius="8" Padding="20" Margin="0,0,0,20"
                   Visibility="Collapsed">
                <StackPanel>
                    <TextBlock Text="Scanning registry..." FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                    <ProgressBar x:Name="ScanProgressBar" Height="8" IsIndeterminate="True"/>
                    <TextBlock x:Name="ScanStatusText" Text="Initializing..." FontSize="13" Margin="0,10,0,0"/>
                </StackPanel>
            </Border>

            <!-- Results Summary -->
            <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                   BorderThickness="1" CornerRadius="8" Padding="20" Margin="0,0,0,20">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Issues Found" FontSize="12" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                        <TextBlock x:Name="IssuesFoundText" Text="0" FontSize="32" FontWeight="Bold" Foreground="#FF6B6B"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1">
                        <TextBlock Text="Cleaned" FontSize="12" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                        <TextBlock x:Name="CleanedCountText" Text="0" FontSize="32" FontWeight="Bold" Foreground="#00D900"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Space Freed" FontSize="12" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                        <TextBlock x:Name="SpaceFreedText" Text="0 KB" FontSize="32" FontWeight="Bold"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Issues List -->
            <TextBlock Text="Registry Issues" FontSize="18" FontWeight="SemiBold" Margin="0,10,0,15"/>
            
            <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                   BorderThickness="1" CornerRadius="4" Padding="0">
                <ListView x:Name="IssuesListView"
                         Height="350"
                         SelectionMode="Extended"
                         BorderThickness="0">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Issue Type" Width="180">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding IssueType}" FontWeight="SemiBold"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Registry Path" Width="350">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding RegistryPath}" TextTrimming="CharacterEllipsis"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Severity" Width="100">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Severity}" Foreground="{Binding SeverityColor}"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Size" Width="80">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Size}"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Border>

            <!-- Quick Actions -->
            <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                   BorderThickness="1" CornerRadius="8" Padding="20" Margin="0,20,0,0">
                <StackPanel>
                    <TextBlock Text="Quick Registry Optimizations" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15"/>
                    
                    <Button Content="⚡ Compact Registry Hives" 
                           Click="CompactRegistry_Click" 
                           Padding="15,8" 
                           Margin="0,0,0,8"
                           HorizontalAlignment="Left"/>
                    
                    <Button Content="🔧 Repair Permissions" 
                           Click="RepairPermissions_Click" 
                           Padding="15,8" 
                           Margin="0,0,0,8"
                           HorizontalAlignment="Left"/>
                    
                    <Button Content="🔄 Defragment Registry" 
                           Click="DefragRegistry_Click" 
                           Padding="15,8"
                           HorizontalAlignment="Left"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
